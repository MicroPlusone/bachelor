## 问题的提出与描述
太阳耀斑是一种重要的太阳风暴事件，其爆发能量来源于活动区的磁场。针对当前太阳风暴预报研究工作中面临的问题，本次比赛利用太阳活动区磁场观测图和对应的耀斑事件标签，基于人工智能方法建立太阳耀斑预报模型，对太阳耀斑事件进行准确预警。

## 数据说明

输入为黑子群的磁图和已计算提取的磁特征参量。
（1）磁图的文件格式为.jpg，位于dataset_ss2sff/magnetogram_jpg；
（2）磁特征参量位于dataset_ss2sff/para_flare.txt，共有11列数据，第1列为对应的黑子群磁图文件名称，第2-11列为磁特征参数。
（3）输出为未来48小时内的耀斑发生情况，位于dataset_ss2sff/magnetogram_jpg/desktop.ini，0 表示不发生，1 表示发生。

磁图名称：hmi.sharp_720s.5772.20150717_111200_TAI.magnetogram.jpg，其中，5772表示观测对象的黑子群编号，20150717_111200表示观测时间“年月日_时分秒”。


我们在构建测试集时：
测试集磁图存于test_input，并隐藏观测对象编号信息，打乱为样本编号，同时去除样本的具体日期时间信息，仅保留同一黑子群观测文件的时序信息，如：
hmi.sharp_720s.0001.00000001_000000_TAI.continuum.fits
hmi.sharp_720s.0001.00000001_013600_TAI.continuum.fits
hmi.sharp_720s.0002.00000001_000000_TAI.continuum.fits
hmi.sharp_720s.0002.00000001_013600_TAI.continuum.fits
hmi.sharp_720s.0002.00000001_031200_TAI.continuum.fits

提醒：两类标签对应的样本数目是不均衡的，未来48小时发生了耀斑的样本与未发生耀斑的样本数分别为2837和56869，在将样本分为训练样本和验证样本时，不建议利用随机方式进行选择。



## ViT用于太阳耀斑预测的建模与实验方案
### 1. 问题梳理

输入：磁图（.jpg图片）+ 磁特征参量（10个数值特征）

输出：未来48小时是否爆发太阳耀斑（二分类，标签 0/1）

挑战：

类别极度不均衡（阳性样本远小于阴性样本）;图像与结构化特征是异质数据;测试集打乱无时间信息，需要小心避免数据泄漏

### 2. 模型架构设计

#### 输入部分

磁图经ViT提取图像特征

磁特征参量经MLP提取特征

#### 编码与融合

每一张磁图输出一个视觉特征向量

每一组磁特征输出一个特征向量

图像特征与磁特征在每个时间步拼接

#### 序列建模与分类

将时间序列特征输入LSTM/Transformer建模时序信息;最后通过分类器输出预测结果



### 4. 数据处理

磁图：resize至224x224，归一化

磁特征：标准化

每个黑子群作为一个样本，序列输入

### 5. 损失函数与评估

加权交叉熵/Focal Loss

评估指标：F1-score，Recall，PR-AUC

### 6. 小结

项目|内容

输入|磁图序列 + 磁特征序列

主干模型|ViT Backbone

序列建模|LSTM/Transformer

融合方式|特征拼接

损失函数|加权CE或Focal Loss

关键注意|保持黑子群划分防止泄漏

